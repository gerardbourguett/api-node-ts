{"version":3,"file":"client.js","sourceRoot":"","sources":["../../src/client.ts"],"names":[],"mappings":"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","sourcesContent":["import { Buffer } from 'node:buffer';\nimport { randomBytes } from 'node:crypto';\nimport { constants } from 'node:os';\nimport { env, nextTick } from 'node:process';\nimport { Socket } from 'node:net';\nimport { Writable } from 'node:stream';\nimport { ConnectionOptions, TLSSocket, connect as tls, createSecureContext } from 'node:tls';\n\nimport { Event as TypedEvent } from 'ts-typed-events';\n\nimport { Defaults, Environment } from './defaults.js';\nimport * as logger from './logging.js';\n\nimport { postgresqlErrorCodes } from './errors.js';\nimport { Queue } from './queue.js';\nimport { Query } from './query.js';\n\nimport {\n    DataHandler,\n    ResultIterator,\n    ResultRecord,\n    makeResult\n} from './result.js';\n\nimport {\n    ClientConnectionDefaults,\n    ClientConnectionOptions,\n    DatabaseError,\n    ErrorLevel,\n    Message,\n    Reader,\n    RowDescription,\n    SSLResponseCode,\n    TransactionStatus,\n    Writer\n} from './protocol.js';\n\nimport {\n    BufferEncoding,\n    DataFormat,\n    DataType,\n    ValueTypeReader\n} from './types.js';\n\nimport { md5 } from './utils.js';\n\nexport interface ConnectionInfo  {\n    encrypted: boolean;\n    parameters: ReadonlyMap<string, string>;\n}\n\nexport interface ClientNotice extends DatabaseError {\n    level: ErrorLevel,\n    code: keyof typeof postgresqlErrorCodes,\n    message: string\n}\n\nexport interface DataTypeError {\n    dataType: DataType,\n    value: any\n}\n\nexport enum SSLMode {\n    Disable = 'disable',\n    Prefer = 'prefer',\n    Require = 'require',\n}\n\nexport interface SSL {\n    mode: (SSLMode.Prefer | SSLMode.Require),\n    options?: ConnectionOptions,\n}\n\nexport interface Configuration extends Partial<ClientConnectionDefaults & ClientConnectionOptions> {\n    user?: string,\n    database?: string,\n    host?: string,\n    port?: number,\n    password?: string,\n    types?: Map<DataType, ValueTypeReader>,\n    bigints?: boolean,\n    keepAlive?: boolean,\n    preparedStatementPrefix?: string,\n    connectionTimeout?: number,\n    ssl?: (SSLMode.Disable | SSL)\n}\n\nexport interface Notification {\n    processId: number,\n    channel: string,\n    payload?: string\n}\n\nexport interface PreparedStatement<T = ResultRecord> {\n    close: (portal?: string) => Promise<void>;\n    execute: (\n        values?: any[],\n        portal?: string,\n        format?: DataFormat | DataFormat[],\n        streams?: Record<string, Writable>,\n    ) => ResultIterator<T>\n}\n\nexport type Callback<T> = (data: T) => void;\n\n/* eslint-disable  @typescript-eslint/no-explicit-any */\ntype CallbackOf<U> = U extends any ? Callback<U> : never;\n\ntype Event = (\n    ClientNotice |\n    DatabaseError |\n    Notification\n);\n\ntype Connect = Error | null;\n\ntype End = NodeJS.ErrnoException | null;\n\ntype CloseHandler = () => void;\n\ninterface RowDataHandler {\n    callback: DataHandler,\n    streams: Record<string, Writable>,\n    bigints: boolean,\n}\n\ntype DescriptionHandler = (description: RowDescription) => void;\n\ninterface RowDataHandlerInfo {\n    readonly handler: RowDataHandler;\n    readonly description: RowDescription | null;\n}\n\n// Indicates that an error has occurred.\ntype ErrorHandler = (error: Error | DatabaseError) => void;\n\nconst enum Cleanup {\n    Bind,\n    Close,\n    ErrorHandler,\n    ParameterDescription,\n    PreFlight,\n    RowDescription,\n}\n\ninterface Bind {\n    name: string;\n    format: DataFormat | DataFormat[]\n    portal: string;\n    values: any[],\n    close: boolean\n}\n\ninterface PreFlightQueue {\n    descriptionHandler: DescriptionHandler;\n    dataHandler: RowDataHandler | null;\n    bind: Bind | null;\n}\n\nconst DEFAULTS = new Defaults(env as unknown as Environment);\n\n/** A database client, opening a single connection to the database.\n *\n * @remarks\n * You must open the connection using {@link connect}, otherwise no query will be processed.\n */\nexport class Client {\n    private readonly events = {\n        connect: new TypedEvent<Connect>(),\n        end: new TypedEvent<End>(),\n        error: new TypedEvent<DatabaseError>(),\n        notice: new TypedEvent<ClientNotice>(),\n        notification: new TypedEvent<Notification>()\n    };\n\n    private ending = false;\n    private connected = false;\n    private connecting = false;\n    private error = false;\n\n    private readonly encoding: BufferEncoding;\n    private readonly writer: Writer;\n\n    private readonly clientNonce = randomBytes(18).toString('base64');\n    private serverSignature: string | null = null;\n\n    private expect = 5;\n    private stream = new Socket();\n    private mustDrain = false;\n    private activeRow: Array<any> | null = null;\n\n    private bindQueue = new Queue<RowDataHandlerInfo | null>();\n    private closeHandlerQueue = new Queue<CloseHandler | null>();\n    private cleanupQueue = new Queue<Cleanup>();\n    private errorHandlerQueue = new Queue<ErrorHandler>();\n    private preFlightQueue = new Queue<PreFlightQueue>();\n    private rowDescriptionQueue = new Queue<RowDescription>();\n    private parameterDescriptionQueue = new Queue<Array<DataType>>();\n\n    private nextPreparedStatementId = 0;\n    private activeDataHandlerInfo: RowDataHandlerInfo | null = null;\n    private readonly parameters: Map<string, string> = new Map();\n\n    public closed = true;\n    public processId: number | null = null;\n    public secretKey: number | null = null;\n    public transactionStatus: TransactionStatus | null = null;\n\n    /**\n    * @param config - An optional configuration object, comprised of connection details\n    *     and client configuration. Most of the connection details can also be specified\n    *     using environment variables, see {@link Environment}.\n    */\n    constructor(public readonly config: Configuration = {}) {\n        this.encoding = config.clientEncoding || DEFAULTS.clientEncoding as BufferEncoding || 'utf-8';\n        this.writer = new Writer(this.encoding);\n\n        this.stream.on('close', () => {\n            this.closed = true;\n            this.events.end.emit(null);\n        });\n\n        this.stream.on('connect', () => {\n            const keepAlive =\n                (typeof this.config.keepAlive === 'undefined') ?\n                    this.config.keepAlive : true;\n\n            if (keepAlive) {\n                this.stream.setKeepAlive(true)\n            }\n\n            this.closed = false;\n            this.startup();\n        });\n\n        /* istanbul ignore next */\n        this.stream.on('error', (error: NodeJS.ErrnoException) => {\n            if (this.connecting) {\n                this.events.connect.emit(error);\n            } else {\n                // Don't raise ECONNRESET errors - they can & should be\n                // ignored during disconnect.\n                if (this.ending && error.errno ===\n                    constants.errno.ECONNRESET) return;\n\n                this.events.end.emit(error);\n            }\n        });\n\n        this.stream.on('finish', () => {\n            this.connected = false;\n        });\n    }\n\n    private startup() {\n        const writer = new Writer(this.encoding);\n\n        if (DEFAULTS.sslMode && Object.values(SSLMode).indexOf(DEFAULTS.sslMode as SSLMode) < 0) {\n            throw new Error(\"Invalid SSL mode: \" + DEFAULTS.sslMode);\n        }\n\n        const ssl = this.config.ssl ??\n            (DEFAULTS.sslMode as SSLMode || SSLMode.Disable) === SSLMode.Disable\n                ? SSLMode.Disable\n                : ({ mode: SSLMode.Prefer, options: undefined });\n\n        const settings = {\n            user: this.config.user || DEFAULTS.user,\n            database: this.config.database || DEFAULTS.database,\n            clientMinMessages: this.config.clientMinMessages,\n            defaultTableAccessMethod: this.config.defaultTableAccessMethod,\n            defaultTablespace: this.config.defaultTablespace,\n            defaultTransactionIsolation: this.config.defaultTransactionIsolation,\n            extraFloatDigits: this.config.extraFloatDigits,\n            idleInTransactionSessionTimeout: this.config.idleInTransactionSessionTimeout,\n            idleSessionTimeout: this.config.idleSessionTimeout,\n            lockTimeout: this.config.lockTimeout,\n            searchPath: this.config.searchPath,\n            statementTimeout: this.config.statementTimeout,\n        };\n\n        if (ssl !== SSLMode.Disable) {\n            writer.startupSSL();\n\n            const abort = (error: Error) => {\n                this.handleError(error);\n                this.events.connect.emit(error);\n            }\n\n            const startup = (stream?: Socket) => {\n                if (stream) this.stream = stream;\n                writer.startup(settings);\n                this.receive();\n                this.sendUsing(writer);\n            }\n\n            this.stream.once('data', (buffer: Buffer) => {\n                const code = buffer.readInt8(0);\n                switch (code) {\n                    // Server supports SSL connections, continue.\n                    case SSLResponseCode.Supported:\n                        break\n\n                    // Server does not support SSL connections.\n                    case SSLResponseCode.NotSupported:\n                        if (ssl.mode === SSLMode.Require) {\n                            abort(\n                                new Error(\n                                    'Server does not support SSL connections'\n                                )\n                            );\n                        } else {\n                            startup();\n                        }\n                        return;\n                    // Any other response byte, including 'E'\n                    // (ErrorResponse) indicating a server error.\n                    default:\n                        abort(\n                            new Error(\n                                'Error establishing an SSL connection'\n                            )\n                        );\n                        return;\n                }\n\n                const context = ssl.options ?\n                    createSecureContext(ssl.options) :\n                    undefined;\n\n                const options = {\n                    socket: this.stream,\n                    secureContext: context,\n                    ...(ssl.options ?? {})\n                };\n\n                const stream: TLSSocket = tls(\n                    options,\n                    () => startup(stream)\n                );\n\n                stream.on('error', (error: Error) => {\n                    abort(error);\n                });\n            });\n        } else {\n            writer.startup(settings);\n            this.receive();\n        }\n\n        this.sendUsing(writer);\n    }\n\n    private receive() {\n        let buffer: Buffer | null = null;\n        let offset = 0;\n        let remaining = 0;\n\n        this.stream.on('data', (newBuffer: Buffer) => {\n            const length = newBuffer.length;\n            const size = length + remaining;\n\n            if (buffer && remaining) {\n                const free = buffer.length - offset - remaining;\n                let tail = offset + remaining;\n                if (free < length) {\n                    const tempBuf = Buffer.allocUnsafe(size);\n                    buffer.copy(tempBuf, 0, offset, tail);\n                    offset = 0;\n                    buffer = tempBuf;\n                    tail = remaining;\n                }\n                newBuffer.copy(buffer, tail, 0, length);\n            } else {\n                buffer = newBuffer;\n                offset = 0;\n            }\n\n            try {\n                const read = this.handle(buffer, offset, size);\n                offset += read;\n                remaining = size - read;\n            } catch (error) {\n                logger.warn(error);\n                if (this.connecting) {\n                    this.events.connect.emit(error as Error);\n                } else {\n                    try {\n                        while (this.handleError(error as Error)) {\n                            logger.info(\"Cancelled query due to an internal error\");\n                        }\n                    } catch (error) {\n                        logger.error(\"Internal error occurred while cleaning up query stack\");\n                    }\n                }\n                this.stream.destroy();\n            }\n        });\n\n        this.stream.on('drain', () => {\n            this.mustDrain = false;\n            this.writer.flush();\n            this.send();\n        });\n    }\n\n    /** Connect to the database.\n     *\n     * @remarks\n     * Don't forget to close the connection using {@link end} before exiting.\n     *\n     * @returns The connection information.\n     */\n    connect(host?: string, port?: number, connectionTimeout?: number): Promise<ConnectionInfo> {\n        if (this.connecting) {\n            throw new Error('Already connecting');\n        }\n\n        if (this.error) {\n            throw new Error('Can\\'t connect in error state');\n        }\n        this.connecting = true;\n\n        const timeout = connectionTimeout ?? this.config.connectionTimeout ?? DEFAULTS.connectionTimeout;\n\n        let p = this.events.connect.once().then((error: Connect) => {\n            if (error) {\n                this.connecting = false;\n                this.stream.destroy();\n                throw error;\n            }\n            return {\n                encrypted: this.stream instanceof TLSSocket,\n                parameters: this.parameters as ReadonlyMap<string, string>,\n            }\n        });\n\n        host = host ?? this.config.host ?? DEFAULTS.host;\n        port = port ?? this.config.port ?? DEFAULTS.port;\n\n        if (host.indexOf('/') === 0) {\n            this.stream.connect(host + '/.s.PGSQL.' + port);\n        } else {\n            this.stream.connect(port, host);\n        }\n\n        if (typeof timeout !== \"undefined\") {\n            p = Promise.race([\n                p,\n                new Promise((_, reject) => setTimeout(\n                    () => reject(\n                        new Error(`Timeout after ${timeout} ms`)\n                    ), timeout\n                )),\n            ]) as Promise<ConnectionInfo>\n        }\n        return p;\n    }\n\n    /** End the database connection.\n     *\n     */\n    end() {\n        if (this.ending) {\n            throw new Error('Already ending');\n        }\n\n        if (this.closed) {\n            throw new Error('Connection already closed');\n        }\n\n        if (this.stream.destroyed) {\n            throw new Error('Connection unexpectedly destroyed');\n        }\n\n        this.ending = true;\n\n        if (this.connected) {\n            this.writer.end();\n            this.send();\n            this.stream.end();\n            this.mustDrain = false;\n        } else {\n            this.stream.destroy();\n        }\n        return new Promise<void>((resolve, reject) =>\n            this.events.end.once().then(\n                value => {\n                    if (value === null) resolve();\n                    reject(value);\n                }\n            )\n        );\n    }\n\n    on(event: 'notification', callback: Callback<Notification>): void;\n    on(event: 'error', callback: Callback<DatabaseError>): void;\n    on(event: 'notice', callback: Callback<ClientNotice>): void;\n    on(event: string, callback: CallbackOf<Event>): void {\n        switch (event) {\n            case 'error': {\n                this.events.error.on(\n                    callback as Callback<DatabaseError>);\n                break;\n            }\n            case 'notice': {\n                this.events.notice.on(\n                    callback as Callback<ClientNotice>);\n                break\n            }\n            case 'notification': {\n                this.events.notification.on(\n                    callback as Callback<Notification>);\n                break\n            }\n        }\n    }\n\n    /** Prepare a statement for later execution.\n     *\n     * @returns A prepared statement object.\n     */\n    prepare<T = ResultRecord>(text: Query | string): Promise<PreparedStatement<T>> {\n        const query = typeof text === 'string' ? {text} : text;\n        const providedNameOrGenerated = query.name || (\n            (this.config.preparedStatementPrefix ||\n                DEFAULTS.preparedStatementPrefix) + (\n                this.nextPreparedStatementId++\n            ));\n\n        return new Promise<PreparedStatement<T>>(\n            (resolve, reject) => {\n                const errorHandler: ErrorHandler = (error) => reject(error);\n                this.errorHandlerQueue.push(errorHandler);\n                this.writer.parse(providedNameOrGenerated, query.text, query.types || []);\n                this.writer.describe(providedNameOrGenerated, 'S');\n                this.preFlightQueue.push({\n                    descriptionHandler: (description: RowDescription) => {\n                        const types = this.parameterDescriptionQueue.shift();\n                        this.cleanupQueue.expect(Cleanup.ParameterDescription);\n\n                        resolve({\n                            close: () => {\n                                return new Promise<void>(\n                                    (resolve) => {\n                                        this.writer.close(\n                                            providedNameOrGenerated, 'S');\n                                        this.closeHandlerQueue.push(resolve);\n                                        this.cleanupQueue.push(\n                                            Cleanup.Close\n                                        );\n                                        this.writer.flush();\n                                        this.send();\n                                    }\n                                );\n                            },\n                            execute: (\n                                values?: any[],\n                                portal?: string,\n                                format?: DataFormat | DataFormat[],\n                                streams?: Record<string, Writable>,\n                            ) => {\n                                const result = makeResult<T>(query?.transform);\n                                result.nameHandler(description.names);\n                                const info = {\n                                    handler: {\n                                        callback: result.dataHandler,\n                                        streams: streams || {},\n                                        bigints: query.bigints ?? this.config.bigints ?? true,\n                                    },\n                                    description: description,\n                                };\n                                this.bindAndExecute(info, {\n                                    name: providedNameOrGenerated,\n                                    portal: portal || query.portal || '',\n                                    format: format || query.format || DataFormat.Binary,\n                                    values: values || [],\n                                    close: false\n                                }, types || query.types);\n\n                                return result.iterator\n                            }\n                        })\n                    },\n                    dataHandler: null,\n                    bind: null\n                });\n                this.writer.sync();\n                this.cleanupQueue.push(Cleanup.PreFlight);\n                this.cleanupQueue.push(Cleanup.ErrorHandler);\n                this.send();\n            });\n    }\n\n    /**\n     * Send a query to the database.\n     *\n     * The query string is given as the first argument, or pass a {@link Query}\n     * object which provides more control.\n     *\n     * @param text - The query string, or pass a {@link Query}\n     *     object which provides more control (including streaming values into a socket).\n     * @param values - The query parameters, corresponding to $1, $2, etc.\n     * @returns A promise for the query results.\n     */\n    query<T = ResultRecord>(text: Query | string, values?: any[]): ResultIterator<T> {\n        const query = typeof text === 'string' ? {text} : text;\n\n        if (this.closed && !this.connecting) {\n            throw new Error('Connection is closed.');\n        }\n\n        const format = query?.format;\n        const types = query?.types;\n        const streams = query?.streams;\n        const portal = query?.portal || '';\n        const result = makeResult<T>(query?.transform);\n\n        const descriptionHandler = (description: RowDescription) => {\n            result.nameHandler(description.names);\n        };\n\n        const dataHandler: RowDataHandler = {\n            callback: result.dataHandler,\n            streams: streams || {},\n            bigints: query.bigints ?? this.config.bigints ?? true,\n        };\n\n        if (values && values.length) {\n            const name = (query?.name) || (\n                (this.config.preparedStatementPrefix ||\n                    DEFAULTS.preparedStatementPrefix) + (\n                    this.nextPreparedStatementId++\n                ));\n\n            this.writer.parse(name, query.text, types || []);\n            this.writer.describe(name, 'S');\n            this.preFlightQueue.push({\n                descriptionHandler: descriptionHandler,\n                dataHandler: dataHandler,\n                bind: {\n                    name: name,\n                    portal: portal,\n                    format: format || DataFormat.Binary,\n                    values: values,\n                    close: true\n                }\n            });\n            this.cleanupQueue.push(Cleanup.PreFlight);\n        } else {\n            const name = query.name || '';\n            this.writer.parse(name, query.text);\n            this.writer.bind(name, portal);\n            this.bindQueue.push(null);\n            this.writer.describe(portal, 'P');\n            this.preFlightQueue.push({\n                descriptionHandler: descriptionHandler,\n                dataHandler: dataHandler,\n                bind: null\n            });\n            this.writer.execute(portal);\n            this.writer.close(name, 'S');\n            this.cleanupQueue.push(Cleanup.Bind);\n            this.cleanupQueue.push(Cleanup.PreFlight);\n            this.closeHandlerQueue.push(null);\n            this.cleanupQueue.push(Cleanup.Close);\n        }\n\n        const stack = new Error().stack;\n        this.errorHandlerQueue.push(\n            (error) => {\n                if (stack !== undefined)\n                    error.stack = stack.replace(\n                        /(?<=^Error: )\\n/,\n                        error.toString() + \"\\n\"\n                    );\n                result.dataHandler(error)\n            }\n        );\n\n        this.cleanupQueue.push(Cleanup.ErrorHandler);\n\n        this.writer.sync();\n        this.send();\n        return result.iterator;\n    }\n\n    private bindAndExecute(\n        info: RowDataHandlerInfo,\n        bind: Bind,\n        types: DataType[]) {\n        try {\n            this.writer.bind(\n                bind.name,\n                bind.portal,\n                bind.format,\n                bind.values,\n                types\n            );\n        } catch (error) {\n            info.handler.callback(error as Error);\n            return;\n        }\n\n        this.bindQueue.push(info);\n        this.writer.execute(bind.portal);\n        this.cleanupQueue.push(Cleanup.Bind);\n\n        if (bind.close) {\n            this.writer.close(bind.name, 'S');\n            this.closeHandlerQueue.push(null);\n            this.cleanupQueue.push(Cleanup.Close);\n        }\n\n        this.writer.sync();\n        this.errorHandlerQueue.push(\n            (error) => { info.handler.callback(error); }\n        );\n        this.cleanupQueue.push(Cleanup.ErrorHandler);\n        this.send();\n    }\n\n    private handleError(error: Error): boolean {\n        while (true) {\n            switch (this.cleanupQueue.shiftMaybe()) {\n                case undefined: return false;\n                case Cleanup.Bind: {\n                    this.bindQueue.shift();\n                    break;\n                }\n                case Cleanup.Close: {\n                    this.closeHandlerQueue.shift();\n                    break;\n                }\n                case Cleanup.ErrorHandler: {\n                    const handler = this.errorHandlerQueue.shift();\n                    handler(error);\n                    this.error = true;\n                    return true;\n                }\n                case Cleanup.ParameterDescription: {\n                    // This does not seem to ever happen!\n                    this.parameterDescriptionQueue.shift();\n                    break;\n                }\n                case Cleanup.PreFlight: {\n                    this.preFlightQueue.shift();\n                    break;\n                }\n                case Cleanup.RowDescription: {\n                    this.rowDescriptionQueue.shift();\n                    break;\n                }\n            }\n        }\n    }\n\n    private send() {\n        if (this.mustDrain || !this.connected) return;\n        this.sendUsing(this.writer);\n    }\n\n    private sendUsing(writer: Writer) {\n        if (this.ending) return;\n        if (!this.stream.writable) throw new Error('Stream not writable');\n        const full = writer.send(this.stream);\n        if (full !== undefined) {\n            this.mustDrain = !full;\n        }\n    }\n\n    private parseError(buffer: Buffer) {\n        let level: DatabaseError['level'] | null = null;\n        let code: DatabaseError['code'] | null = null;\n        let message: DatabaseError['message'] | null = null;\n        let details: string | null = null;\n\n        const length = buffer.length;\n        let offset = 0;\n\n        while (offset < length) {\n            const next = buffer.indexOf(0, offset);\n            if (next < 0) break;\n\n            const value = buffer.subarray(offset + 1, next).toString();\n            switch (buffer[offset]) {\n                case 0x53: {\n                    if (level === null) {\n                        level = value as DatabaseError['level'];\n                    }\n                    break;\n                }\n                case 0x56: {\n                    level = value as DatabaseError['level'];\n                    break;\n                }\n                case 0x43: {\n                    code = value as DatabaseError['code'];\n                    break;\n                }\n                case 0x44: {\n                    details = value;\n                    break;\n                }\n                case 0x4d: {\n                    message = value;\n                    break;\n                }\n                default:\n                    break;\n            }\n\n            offset = next + 1;\n        }\n\n        if (level && code && message) {\n            return new DatabaseError(level, code, details ? `${message}: ${details}` : message);\n        }\n\n        throw new Error('Unable to parse error message.');\n    }\n\n    private handle(buffer: Buffer, offset: number, size: number): number {\n        let read = 0;\n\n        while (size >= this.expect + read) {\n            let frame = offset + read;\n            let mtype: Message = buffer.readInt8(frame);\n\n            // Fast path: retrieve data rows.\n            if (mtype === Message.RowData) {\n                const info = this.activeDataHandlerInfo;\n\n                if (!info) {\n                    throw new Error('No active data handler');\n                }\n\n                if (!info.description) {\n                    throw new Error('No result type information');\n                }\n\n                const {\n                    handler: {\n                        callback,\n                        streams,\n                        bigints,\n                    },\n                    description: {\n                        columns,\n                        names,\n                    }\n                } = info;\n\n                let row = this.activeRow;\n\n                const types = this.config.types;\n                const encoding = this.encoding;\n\n                const hasStreams = Object.keys(streams).length > 0;\n                const mappedStreams = hasStreams ? names.map(\n                    name => streams[name]\n                ) : undefined;\n\n                while (true) {\n                    mtype = buffer.readInt8(frame);\n                    if (mtype !== Message.RowData) break;\n\n                    const bytes = buffer.readInt32BE(frame + 1) + 1;\n                    const start = frame + 5;\n\n                    if (size < 11 + read) {\n                        this.expect = 7;\n                        this.activeRow = row;\n                        return read;\n                    }\n\n                    if (row === null) {\n                        const count = buffer.readInt16BE(start);\n                        row = new Array<any>(count);\n                    }\n\n                    const startRowData = start + 2;\n                    const reader = new Reader(buffer, startRowData, bytes + read);\n                    const end = reader.readRowData(\n                        row,\n                        columns,\n                        encoding,\n                        bigints,\n                        types,\n                        mappedStreams\n                    );\n\n                    const remaining = bytes + read - size;\n                    if (remaining <= 0) {\n                        callback(row);\n                        row = null;\n                    } else {\n                        const offset = startRowData + end;\n                        buffer.writeInt8(mtype, offset - 7);\n                        buffer.writeInt32BE(bytes - end - 1, offset - 6);\n                        buffer.writeInt16BE(row.length, offset - 2);\n                        this.expect = 12;\n                        this.activeRow = row;\n                        return read + end;\n                    }\n\n                    // Keep track of how much data we've consumed.\n                    frame += bytes;\n\n                    // If the next message header doesn't fit, we\n                    // break out and wait for more data to arrive.\n                    if (size < frame + 5) {\n                        this.activeRow = row;\n                        this.expect = 5;\n                        return read;\n                    }\n\n                    read += bytes;\n                }\n\n                this.activeRow = null;\n            }\n\n            const bytes = buffer.readInt32BE(frame + 1) + 1;\n            const length = bytes - 5;\n\n            if (size < bytes + read) {\n                this.expect = bytes;\n                break;\n            }\n\n            this.expect = 5;\n            read += bytes;\n\n            // This is the start offset of the message data.\n            const start = frame + 5;\n\n            switch (mtype as Message) {\n                case Message.Authentication: {\n                    const writer = new Writer(this.encoding);\n                    const code = buffer.readInt32BE(start);\n                    outer:\n                    /* istanbul ignore next */\n                    switch (code) {\n                        case 0: {\n                            nextTick(() => {\n                                this.events.connect.emit(null);\n                            });\n                            break;\n                        }\n                        case 3: {\n                            const s = this.config.password || DEFAULTS.password || '';\n                            writer.password(s);\n                            break;\n                        }\n                        case 5: {\n                            const { user = '', password = '' } = this.config;\n                            const salt = buffer.subarray(start + 4, start + 8);\n                            const shadow = md5(\n                                `${password || DEFAULTS.password}` +\n                                `${user || DEFAULTS.user}`\n                            );\n                            writer.password(`md5${md5(shadow, salt)}`);\n                            break;\n                        }\n                        case 10: {\n                            const reader = new Reader(buffer, start + 4);\n                            const mechanisms: string[] = [];\n                            while (true) {\n                                const mechanism = reader.readCString(this.encoding);\n                                if (mechanism.length === 0) break;\n                                if (writer.saslInitialResponse(mechanism, this.clientNonce))\n                                    break outer;\n                                mechanisms.push(mechanism);\n                            }\n                            throw new Error(\n                                `SASL authentication unsupported (mechanisms: ${mechanisms.join(', ')})`\n                            );\n                        }\n                        case 11: {\n                            const data = buffer.subarray(start + 4, start + length).toString(\"utf8\");\n                            const password = this.config.password || DEFAULTS.password || '';\n                            this.serverSignature = writer.saslResponse(data, password, this.clientNonce);\n                            break;\n                        }\n                        case 12: {\n                            const data = buffer.subarray(start + 4, start + length).toString(\"utf8\");\n                            if (!this.serverSignature) throw new Error('Server signature missing');\n                            writer.saslFinal(data, this.serverSignature);\n                            break;\n                        }\n                        default:\n                            throw new Error(\n                                `Unsupported authentication scheme: ${code}`\n                            );\n                    }\n                    this.sendUsing(writer);\n                    break;\n                }\n                case Message.BackendKeyData: {\n                    this.processId = buffer.readInt32BE(start);\n                    this.secretKey = buffer.readInt32BE(start + 4);\n                    break;\n                }\n                case Message.BindComplete: {\n                    const info = this.bindQueue.shift();\n                    this.cleanupQueue.expect(Cleanup.Bind);\n                    if (info) {\n                        this.activeDataHandlerInfo = info;\n                    }\n                    break;\n                }\n                case Message.NoData: {\n                    const preflight = this.preFlightQueue.shift();\n                    if (preflight.dataHandler) {\n                        const info = {\n                            handler: preflight.dataHandler,\n                            description: null,\n                        };\n                        if (preflight.bind) {\n                            this.cleanupQueue.expect(Cleanup.ParameterDescription);\n                            this.bindAndExecute(\n                                info,\n                                preflight.bind,\n                                this.parameterDescriptionQueue.shift()\n                            );\n                        } else {\n                            this.activeDataHandlerInfo = info;\n                        }\n                    } else {\n                        preflight.descriptionHandler({\n                            columns: new Uint32Array(0),\n                            names: [],\n                        });\n                    }\n                    this.cleanupQueue.expect(Cleanup.PreFlight);\n                    break;\n                }\n                case Message.EmptyQueryResponse:\n                case Message.CommandComplete: {\n                    const info = this.activeDataHandlerInfo;\n                    if (info) {\n                        const status = buffer.subarray(\n                            start, start + length - 1\n                        ).toString();\n\n                        info.handler.callback(status || null);\n                        this.activeDataHandlerInfo = null;\n                    }\n                    break;\n                }\n                case Message.CloseComplete: {\n                    const handler = this.closeHandlerQueue.shift();\n                    this.cleanupQueue.expect(Cleanup.Close);\n                    if (handler) {\n                        handler();\n                    }\n                    break;\n                }\n                case Message.ErrorResponse: {\n                    const error = this.parseError(\n                        buffer.subarray(start, start + length));\n\n                    if (this.connecting) throw error;\n\n                    this.events.error.emit(error);\n                    loop:\n                    if (!this.handleError(error)) {\n                        throw new Error(\"Internal error occurred while processing database error\");\n                    }\n                    break;\n                }\n                case Message.Notice: {\n                    const notice = this.parseError(\n                        buffer.subarray(start, start + length));\n                    this.events.notice.emit(notice);\n                    break;\n                }\n                case Message.NotificationResponse: {\n                    const reader = new Reader(buffer, start);\n                    const processId = reader.readInt32BE();\n                    const channel = reader.readCString(this.encoding);\n                    const payload = reader.readCString(this.encoding);\n                    this.events.notification.emit({\n                        processId: processId,\n                        channel: channel,\n                        payload: payload\n                    });\n                    break;\n                }\n                case Message.ParseComplete: {\n                    break;\n                }\n                case Message.ParameterDescription: {\n                    const length = buffer.readInt16BE(start);\n                    const types: Array<DataType> = new Array(length);\n                    for (let i = 0; i < length; i++) {\n                        const offset = start + 2 + i * 4;\n                        const dataType = buffer.readInt32BE(offset);\n                        types[i] = dataType;\n                    }\n                    this.cleanupQueue.unshift(Cleanup.ParameterDescription);\n                    this.parameterDescriptionQueue.push(types);\n                    break;\n                }\n                case Message.ParameterStatus: {\n                    const reader = new Reader(buffer, start);\n                    const name = reader.readCString(this.encoding);\n                    const value = reader.readCString(this.encoding);\n                    this.parameters.set(name, value);\n                    break;\n                }\n                case Message.ReadyForQuery: {\n                    if (this.error) {\n                        this.error = false\n                    } else if (this.connected) {\n                        this.errorHandlerQueue.shift();\n                        this.cleanupQueue.expect(Cleanup.ErrorHandler);\n                    } else {\n                        this.connecting = false;\n                        this.connected = true;\n                    }\n                    const status = buffer.readInt8(start);\n                    this.transactionStatus = status as TransactionStatus;\n                    this.send();\n                    break;\n                }\n                case Message.RowDescription: {\n                    const preflight = this.preFlightQueue.shift();\n                    const reader = new Reader(buffer, start);\n                    const description = reader.readRowDescription(this.config.types);\n\n                    preflight.descriptionHandler(description);\n\n                    if (preflight.dataHandler) {\n                        const info = {\n                            handler: preflight.dataHandler,\n                            description: description,\n                        };\n\n                        if (preflight.bind) {\n                            this.cleanupQueue.expect(Cleanup.ParameterDescription);\n                            this.bindAndExecute(\n                                info,\n                                preflight.bind,\n                                this.parameterDescriptionQueue.shift()\n                            );\n                        } else {\n                            this.activeDataHandlerInfo = info;\n                        }\n                    }\n\n                    this.cleanupQueue.expect(Cleanup.PreFlight);\n                    break;\n                }\n                default: {\n                    logger.warn(`Message not implemented: ${mtype}`);\n                    break;\n                }\n            }\n        }\n\n        return read;\n    }\n}\n"]}